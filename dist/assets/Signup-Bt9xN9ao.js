import{r as t,c as E,j as e,f as G,V as l,h as L,d as p,s as q}from"./vendor-JV4b0bO8.js";import{a as d,g as A}from"./index-DwOsTwTZ.js";import{L as M,B as y}from"./Button-C4S57wnW.js";function U(){const[m,N]=t.useState(""),[f,v]=t.useState(""),[h,w]=t.useState(""),[u,j]=t.useState(""),[b,S]=t.useState(""),[x,P]=t.useState(!1),[g,i]=t.useState(!1),c=E(),k=async r=>{var o,n,a;r.preventDefault(),i(!0);try{const s=await G(d,u);if(s.length){l.error(s.includes("google.com")?"That email is already registered via Google. Please sign in with Google.":"That email is already in use. Try signing in instead."),i(!1);return}await L(d,u,b),await p.post("/api/create-user-profile",{email:u,firstName:m,lastName:f,mobileNumber:h}),l.success(`Welcome, ${m}!`),c("/verify-mobile")}catch(s){console.error("Signup error:",s,(o=s.response)==null?void 0:o.data),l.error((a=(n=s.response)==null?void 0:n.data)!=null&&a.error?`Signup failed: ${s.response.data.error}`:"Signup failed. Please try again.")}finally{i(!1)}},C=async()=>{var r;i(!0);try{const n=(await q(d,A)).user.email;let a=null;try{a=(await p.get(`/api/get-profile?email=${n}`)).data}catch(s){if(((r=s.response)==null?void 0:r.status)!==404)throw s}if(a!=null&&a.firstName){await d.signOut(),l.error("Already registered. Please log in."),c("/login");return}await p.post("/api/create-user-profile",{email:n,firstName:"",lastName:"",mobileNumber:""}),l.success("Account created! Please verify mobile."),c("/verify-mobile")}catch(o){console.error("Google signup error:",o),l.error("Google signup failed. Please try again.")}finally{i(!1)}};return e.jsxs(M,{title:"Sign Up for MVP Services",children:[e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"First Name"}),e.jsx("input",{type:"text",value:m,onChange:r=>N(r.target.value),required:!0,className:"w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Last Name"}),e.jsx("input",{type:"text",value:f,onChange:r=>v(r.target.value),required:!0,className:"w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Mobile Number"}),e.jsx("input",{type:"tel",value:h,onChange:r=>w(r.target.value.replace(/\D/g,"").slice(0,10)),required:!0,className:"w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-purple-500",maxLength:10,pattern:"\\d{10}"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Email"}),e.jsx("input",{type:"email",value:u,onChange:r=>j(r.target.value),required:!0,className:"w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Password"}),e.jsx("input",{type:x?"text":"password",value:b,onChange:r=>S(r.target.value),required:!0,className:"w-full border border-gray-300 px-3 py-2 rounded-md pr-10 focus:ring-2 focus:ring-purple-500"}),e.jsx("span",{onClick:()=>P(r=>!r),className:"absolute right-3 top-9 cursor-pointer text-gray-500 select-none",children:x?"🙈":"👁️"})]}),e.jsx(y,{type:"submit",disabled:g,className:"w-full",children:g?"Signing up…":"Sign Up"})]}),e.jsx("div",{className:"text-center font-semibold my-6",children:"OR"}),e.jsxs(y,{onClick:C,disabled:g,className:"w-full !text-gray-800 flex items-center justify-center border border-gray-300 bg-white hover:bg-gray-100",children:[e.jsx("img",{src:"/google-logo.svg",alt:"Google",className:"w-5 h-5 mr-2"}),"Sign up with Google"]}),e.jsxs("p",{className:"mt-6 text-center text-sm",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>c("/login"),className:"text-purple-600 font-medium underline",children:"Log In"})]})]})}export{U as default};
